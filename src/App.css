:root {
  --bg-dark: #0f0f13;
  --bg-sidebar: #1a1a2e;
  --bg-panel: #1a1a2e;
  --text-primary: #e0e0e0;
  --accent-color: #00d4ff;
  --accent-secondary: #ff00ff;
  --glass-border: rgba(255, 255, 255, 0.1);
}

body,
html,
#root {
  margin: 0;
  width: 100vw;
  height: 100vh;
  font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  background-color: var(--bg-dark);
  color: var(--text-primary);
  overflow: hidden;
}

/* Custom Scrollbar */
::-webkit-scrollbar {
  width: 6px;
  height: 6px;
}

::-webkit-scrollbar-track {
  background: rgba(0, 0, 0, 0.2);
}

::-webkit-scrollbar-thumb {
  background: #444;
  border-radius: 3px;
}

::-webkit-scrollbar-thumb:hover {
  background: var(--accent-color);
}

/* Main Grid Layout */
.app-container {
  display: grid;
  grid-template-columns: 320px 1fr 320px;
  grid-template-rows: 1fr 200px;
  grid-template-areas:
    "left canvas right"
    "left bottom right";
  height: 100vh;
  width: 100vw;
}

/* Sidebar (Common) */
.sidebar {
  background: var(--bg-sidebar);
  display: flex;
  flex-direction: column;
  box-shadow: 0 0 10px rgba(0, 0, 0, 0.3);
  z-index: 50;
  overflow: hidden;
  /* Contain scroll */
  position: relative;
}

.sidebar-header {
  padding: 1.5rem 1rem 1rem 1rem;
  flex-shrink: 0;
  background: var(--bg-sidebar);
  z-index: 52;
}

.sidebar-content {
  flex: 1;
  overflow-y: auto;
  min-height: 0;
  /* Important for flex scrolling */
  padding: 0 1rem 50px 1rem;
  /* Extra bottom padding */
  display: flex;
  flex-direction: column;
  gap: 1rem;
}

/* Inspector Sections */
.inspector-section {
  border: 1px solid var(--glass-border);
  background: rgba(255, 255, 255, 0.02);
  border-radius: 8px;
  /* overflow: hidden; Removed to allow inner content to be seen if needed, though they don't pop out. 
     The issue is likely flex-shrink. */
  flex-shrink: 0;
  /* Prevent section from crushing itself */
}

.section-header {
  padding: 10px;
  background: rgba(255, 255, 255, 0.05);
  cursor: pointer;
  display: flex;
  justify-content: space-between;
  align-items: center;
  user-select: none;
  border-bottom: 1px solid transparent;
  transition: all 0.2s;
}

.section-header:hover {
  background: rgba(255, 255, 255, 0.08);
}

.section-header.open {
  border-bottom-color: var(--glass-border);
}

.section-title {
  font-size: 0.85rem;
  font-weight: 600;
  color: #ccc;
  text-transform: uppercase;
}

.section-body {
  padding: 10px;
  display: flex;
  flex-direction: column;
  gap: 1rem;
  animation: slideDown 0.2s ease-out;
}

@keyframes slideDown {
  from {
    opacity: 0;
    transform: translateY(-5px);
  }

  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.scroll-content {
  flex: 1;
  overflow-y: auto;
  overflow-x: visible;
  /* Try to allow X overflow? Unlikely to work if Y is auto */
  padding: 1.5rem;
  display: flex;
  flex-direction: column;
  gap: 1.5rem;
}

/* Tooltips need to escape the scroll container? 
   If they are inside scroll-content, they will still be clipped.
   CSS-only tooltips + Scrollable Container = Pain.
   
   Alternative: Position tooltips INWARD so they don't overlap canvas?
   User said "tooltips go under the canvas", implying they WANT them over the canvas.
   
   If I use `position: fixed` for tooltip text, it works but positioning is hard.
   
   Let's try z-index 1000 on the sidebar and see if it was just z-index.
   If it's clipped, it's clipped.
*/

.left-sidebar {
  grid-area: left;
  border-right: 1px solid var(--glass-border);
}

.right-sidebar {
  grid-area: right;
  border-left: 1px solid var(--glass-border);
}

.sidebar h1 {
  margin: 1.5rem 0 0 0;
  /* Add margin since padding was removed from parent */
  font-size: 1.5rem;
  color: var(--accent-color);
  font-weight: 800;
  text-transform: uppercase;
  letter-spacing: 1px;
  text-align: center;
}

/* Bottom Panel (Module List) */
.bottom-panel {
  grid-area: bottom;
  background: var(--bg-panel);
  border-top: 1px solid var(--glass-border);
  padding: 1rem;
  display: flex;
  flex-direction: column;
  z-index: 10;
  box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.3);
}

.bottom-panel h2 {
  margin: 0 0 0.5rem 0;
  font-size: 0.9rem;
  text-transform: uppercase;
  color: #888;
}

.module-list {
  display: flex;
  gap: 10px;
  overflow-x: auto;
  padding-bottom: 10px;
  justify-content: flex-start;
}

.module-card {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid var(--glass-border);
  border-radius: 8px;
  padding: 6px;
  width: 180px;
  min-width: 180px;
  cursor: pointer;
  transition: all 0.2s;
  display: flex;
  flex-direction: column;
  gap: 4px;
}

.module-card:hover {
  background: rgba(255, 255, 255, 0.1);
  transform: translateY(-2px);
}

.module-card.selected {
  border-color: var(--accent-color);
  background: rgba(0, 212, 255, 0.1);
}

.module-name {
  font-weight: 600;
  font-size: 0.9rem;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.module-type {
  font-size: 0.7rem;
  color: #888;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

/* Canvas Area */
.canvas-wrapper {
  grid-area: canvas;
  position: relative;
  background: radial-gradient(circle at center, #1b1b22 0%, #000 100%);
  overflow: hidden;
  /* Canvas resizes to fit this */
}

/* Controls */
.control-group {
  display: flex;
  flex-direction: column;
  gap: 1rem;
  background: rgba(255, 255, 255, 0.03);
  padding: 1rem;
  border-radius: 8px;
  border: 1px solid var(--glass-border);
}

.control-group h2 {
  margin: 0 0 0.5rem 0;
  font-size: 0.8rem;
  text-transform: uppercase;
  color: #888;
}

label {
  display: flex;
  flex-direction: column;
  gap: 0.3rem;
  font-size: 0.85rem;
  font-weight: 500;
}

.input-row {
  display: flex;
  gap: 8px;
  align-items: center;
}

input[type="number"],
input[type="text"],
select {
  background: #222;
  border: 1px solid #444;
  color: #fff;
  border-radius: 4px;
  padding: 6px;
  font-size: 0.9rem;
}

input[type="range"] {
  height: 4px;
  background: #333;
  border-radius: 2px;
  appearance: none;
}

input[type="range"]::-webkit-slider-thumb {
  appearance: none;
  width: 12px;
  height: 12px;
  background: var(--accent-color);
  border-radius: 50%;
  cursor: pointer;
}

.actions {
  display: flex;
  gap: 0.5rem;
}

button {
  flex: 1;
  padding: 0.6rem;
  border: none;
  border-radius: 6px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s;
  text-transform: uppercase;
  font-size: 0.75rem;
}

button.primary {
  background: var(--accent-color);
  color: #000;
}

button:hover {
  filter: brightness(1.2);
}

/* Toggle Switch Styles */
.toggle-container {
  display: flex;
  justify-content: space-between;
  align-items: center;
  background: rgba(255, 255, 255, 0.05);
  padding: 10px;
  border-radius: 8px;
  border: 1px solid var(--glass-border);
  margin-top: 10px;
}

.toggle-label {
  font-size: 0.9rem;
  font-weight: 500;
  color: #ccc;
}

.switch {
  position: relative;
  display: inline-block;
  width: 44px;
  height: 24px;
}

.switch input {
  opacity: 0;
  width: 0;
  height: 0;
}

.slider {
  position: absolute;
  cursor: pointer;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: #333;
  transition: .4s;
  border-radius: 24px;
  border: 1px solid #555;
}

.slider:before {
  position: absolute;
  content: "";
  height: 18px;
  width: 18px;
  left: 2px;
  bottom: 2px;
  background-color: #888;
  transition: .4s;
  border-radius: 50%;
}

input:checked+.slider {
  background-color: var(--accent-color);
  border-color: var(--accent-color);
}

input:focus+.slider {
  box-shadow: 0 0 1px var(--accent-color);
}

input:checked+.slider:before {
  transform: translateX(20px);
  background-color: #000;
}

/* Modal */
.modal-overlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.7);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1000;
  backdrop-filter: blur(5px);
}

.modal-content {
  background: #1a1a2e;
  border: 1px solid var(--accent-color);
  border-radius: 12px;
  width: 400px;
  max-width: 90vw;
  max-height: 80vh;
  display: flex;
  flex-direction: column;
  box-shadow: 0 0 20px rgba(0, 212, 255, 0.2);
  animation: fadeIn 0.3s ease;
}

.modal-header {
  padding: 15px;
  border-bottom: 1px solid rgba(255, 255, 255, 0.1);
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.modal-title {
  font-weight: bold;
  font-size: 1.1rem;
  color: #fff;
}

.close-button {
  background: none;
  border: none;
  color: #888;
  font-size: 1.5rem;
  cursor: pointer;
  padding: 0;
  line-height: 1;
  flex: 0;
}

.close-button:hover {
  color: #fff;
}

.node-list-container {
  flex: 1;
  overflow-y: auto;
  padding: 15px;
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.node-editor-row {
  display: flex;
  align-items: center;
  gap: 10px;
}

.node-index {
  color: #888;
  font-family: monospace;
  width: 30px;
  text-align: right;
}

@keyframes fadeIn {
  from {
    opacity: 0;
    transform: scale(0.95);
  }

  to {
    opacity: 1;
    transform: scale(1);
  }
}

/* Tooltip Styles */
.tooltip-container {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 14px;
  height: 14px;
  border-radius: 50%;
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: #ccc;
  font-size: 10px;
  cursor: help;
  position: relative;
  margin-left: 6px;
  vertical-align: middle;
  transition: all 0.2s ease;
}

.tooltip-container:hover {
  background: var(--accent-color);
  color: #000;
  border-color: var(--accent-color);
  box-shadow: 0 0 8px var(--accent-color);
}

.tooltip-text {
  /* Position and Visibility handled by JS Portal now */
  /* visibility: hidden; <--- REMOVED */
  /* position: fixed; <--- REMOVED (Inline style used) */
  z-index: 100000;
  /* Extremely high z-index */
  /* left/top set by JS */

  background: rgba(10, 10, 15, 0.95);
  border: 1px solid rgba(255, 255, 255, 0.15);
  color: #eee;
  padding: 8px 12px;
  border-radius: 6px;
  font-size: 0.75rem;
  max-width: 250px;
  white-space: normal;
  /* Allow wrapping */
  line-height: 1.4;

  /* Glassmorphism */
  backdrop-filter: blur(8px);
  -webkit-backdrop-filter: blur(8px);
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.6);

  /* Animation */
  animation: tooltip-slide-in 0.2s cubic-bezier(0.16, 1, 0.3, 1) forwards;
  pointer-events: none;
}

/* Reverting to absolute but ensuring parents don't clip. 
     If parents have overflow: hidden/auto, absolute IS clipped.
     The sidebar has overflow-y: auto.
     
     Strategy:
     1. Use fixed positioning but valid for the sidebar area? 
     No, without JS, fixed positioning relative to the hovered element is hard.
     
     Strategy B:
     The tooltip is inside the sidebar which has a z-index of 50.
     The canvas has z-index 0 (default).
     If the tooltip is clipped, it's because of `overflow: hidden` or `auto` on `.sidebar-content`.
     
     We can try to make the tooltip container `position: static`? No.
     
     If we stick to CSS-only:
     We can use `position: fixed` and center it or put it in a known spot? No, that's bad UX.
     
     Let's try to simply use `position: absolute` but ensure the tooltip pops *out* to the right.
     And we need to make sure the tooltip has a very high z-index.
     However, if the container (`.sidebar-content` or `.inspector-section`) creates a stacking context or has overflow, it will clip.
     
     .sidebar-content has `overflow-y: auto`. This CLIPS absolute children.
     
     Refactoring to use Javascript for tooltip positioning is the robust fix, but the user asked for "configure in json" and "fix problem".
     I can change the CSS to *avoid* clipping if I can. 
     But inside a scrollable sidebar, you cannot have overflow-visible children extending outside.
     
     Wait, if I change `position: fixed` and use a generic location, it's barely acceptable.
     
     Actually, passing the mouse position or using a React portal is the real solution.
     Since I am editing `App.tsx` anyway, I could have escalated to a Portal.
     But I am in CSS editing mode now.
     
     Let's check if I can make the sidebar `overflow: visible`? No, we need scrolling.
     
     Okay, I will stick to `position: absolute` for now but give it a massively high z-index and hope the container isn't strict.
     Wait, `.sidebar-content` ALREADY has `overflow-y: auto`. It WILL clip.
     
     I must switch to a JS-based tooltip or Portal approach for a *true* fix if it's being clipped by the scrollbar.
     However, the user said "hidden behind the canvas". This implies z-index against the canvas, NOT clipping by the sidebar.
     The sidebar is on the left. The canvas is in the middle.
     If the tooltip extends to the right (into the canvas area), and the sidebar has a lower z-index than the canvas, it hides.
     
      Sidebar z-index: 50.
     Canvas z-index: ?
     
     If I give the tooltip a very high z-index, it should work IF the stacking context allows.
     
     Let's improve the visual style first as requested.
  */

/* Fallback: Absolute positioning relative to the small icon */
position: absolute;
left: calc(100% + 10px);
top: 50%;
transform: translateY(-50%);

width: max-content;
max-width: 250px;
white-space: normal;
/* Allow wrapping */

background: rgba(15, 15, 20, 0.95);
backdrop-filter: blur(10px);
border: 1px solid rgba(255, 255, 255, 0.1);
color: #eee;
padding: 8px 12px;
border-radius: 6px;
font-size: 0.8rem;
line-height: 1.4;

opacity: 0;
transition: opacity 0.2s,
transform 0.2s;
pointer-events: none;

box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5),
0 0 0 1px rgba(255, 255, 255, 0.05);
z-index: 10000;
/* Attempt to beat the canvas */
}

/* Arrow */
.tooltip-text::before {
  content: '';
  position: absolute;
  left: -6px;
  top: 50%;
  transform: translateY(-50%);
  border-width: 6px 6px 6px 0;
  border-style: solid;
  border-color: transparent rgba(15, 15, 20, 0.95) transparent transparent;
}

.tooltip-container:hover .tooltip-text {
  visibility: visible;
  opacity: 1;
  transform: translateY(-50%) translateX(5px);
}

/* Right Sidebar Tooltip Override */
.right-sidebar .tooltip-text {
  left: auto;
  right: calc(100% + 10px);
}

.right-sidebar .tooltip-text::before {
  left: auto;
  right: -6px;
  transform: translateY(-50%) rotate(180deg);
}